/* Michelle Tanco * 2018 April 4th * Exploring questions around jobs */-- Movie ID, Director Name, Actordrop table if exists director_actor;create table director_actor distribute by replication asselect director_name, actor_name, actor_type, count(*) as cntfrom (	select director_name, actor_1_name as actor_name, 1::int as actor_type from imdb_scrape	union	select director_name, actor_2_name as actor_name, 2::int as actor_type from imdb_scrape	union	select director_name, actor_3_name as actor_name, 3::int as actor_type from imdb_scrape;) as rel group by 1,2,3;select * from director_actor limit 3;--director_name		actor_name	actor_type	cnt--Lasse Hallstr		Hope Davis		1		1--Anthony Hickox	Julian Sands	1		1--Maurice Joyce		Frank Welker	1		1